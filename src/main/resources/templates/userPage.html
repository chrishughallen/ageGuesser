<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="partials/head :: header('User Page')">

</head>

<nav th:replace="partials/navbar :: navbar"></nav>


<div class="container">
    <main>

        <img class="userImg" th:src="${user.photo}" alt="">
        <input placeholder="How old do I look?" class="form-control" id="guess">
        <br />
        <!--Button to trigger modal and check guess-->
        <button data-backdrop="static" data-keyboard="false" id="checkGuess" type="button" class="btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-sm">Submit</button>


    <!--Modal that displays outcome of guess and button to go to next user page - cant be closed-->
        <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
            <div class="modal-dialog modal-sm" role="document">
                <div id="outcomeModal" class="modal-content">
                    <h3 id="outcome" class="text-center"></h3>
                    <form th:action="@{/guess/{id}(id=${user.id})}" method="POST" th:object="${Guess}">
                        <button id="resetColorBtn" class="btn btn-success">Next</button>
                        <input type="hidden" id="age" th:field="*{age}" />
                    </form>
                </div>
            </div>
        </div>
    </main>

</div>





<footer th:replace="partials/footer :: footer"></footer>



<script th:inline="javascript">

    function isNumeric(n) {
        return !isNaN(parseFloat(n)) && isFinite(n);
    }

    (function() {
        $('#checkGuess').addClass('disabled');
        $('#guess').keyup(function() {

            var empty = false;

            $('#guess').each(function() {
                if ($(this).val() == '' || !isNumeric($(this).val())) {
                    empty = true;
                }
            });

            if (empty) {
                $('#checkGuess').addClass('disabled'); // updated according to http://stackoverflow.com/questions/7637790/how-to-remove-disabled-attribute-with-jquery-ie
            } else {
                $('#checkGuess').removeClass('disabled'); // updated according to http://stackoverflow.com/questions/7637790/how-to-remove-disabled-attribute-with-jquery-ie
            }
        });
    })();


    var age = /*[[${age}]]*/ {};
    console.log(age);

    $('#checkGuess').click(function(){

        if($('#guess').val().length === 0){
            $('#outcome').text("Wrong! At least guess something!")
            $('#age').val(0)
        }

        if(age == $('#guess').val() ) {
            $('#outcome').text("CORRECT!");
            $('#age').val($('#guess').val())
        }
        else $('#outcome').text("INCORRECT!")
             $('#age').val($('#guess').val())
    });
</script>